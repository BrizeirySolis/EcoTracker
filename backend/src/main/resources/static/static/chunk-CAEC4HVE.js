import{b as k,c as K}from"./chunk-DL6DNOIO.js";import{c as R,f as W,l as $,m as q,n as Y,q as J}from"./chunk-JA5G44CU.js";import{a as A}from"./chunk-RSETXWHU.js";import{E as S,F as a,H as E,Ha as H,I as B,La as U,M as m,O as L,P as l,R as t,S as i,T as s,W as C,X as f,Y as d,ba as r,ca as v,da as h,fa as I,g as O,ga as T,ha as V,ja as y,k as P,ka as w,l as M,ma as D,na as F,va as j,w as b,wa as z,x,xa as N,y as g,ya as G,z as _}from"./chunk-22ZNRLWF.js";var X=()=>["/bitacoras/new"],Z=n=>["/bitacoras",n],ee=n=>["/bitacoras/edit",n],te=()=>["/bitacoras/timeline"];function ne(n,o){if(n&1&&(t(0,"option",18),r(1),i()),n&2){let e=o.$implicit;l("value",e[0]),a(),v(e[1])}}function ie(n,o){n&1&&(t(0,"div",19),s(1,"div",20),t(2,"p"),r(3,"Cargando bit\xE1coras..."),i()())}function oe(n,o){n&1&&(t(0,"p"),r(1,"No hay bit\xE1coras en la categor\xEDa seleccionada."),i())}function ae(n,o){n&1&&(t(0,"p"),r(1,"Comienza registrando tus actividades ambientales."),i())}function re(n,o){if(n&1&&(t(0,"div",21),g(),t(1,"svg",22),s(2,"path",23)(3,"polyline",24)(4,"line",25)(5,"line",26),i(),_(),t(6,"h3"),r(7,"No hay bit\xE1coras disponibles"),i(),m(8,oe,2,0,"p",27)(9,ae,2,0,"p",27),t(10,"a",28),r(11,"Crear primera bit\xE1cora"),i()()),n&2){let e=d();a(8),l("ngIf",e.selectedCategoria),a(),l("ngIf",!e.selectedCategoria),a(),l("routerLink",y(3,X))}}function ce(n,o){if(n&1){let e=C();t(0,"div",29),g(),t(1,"svg",30),s(2,"circle",31)(3,"line",32)(4,"line",33),i(),_(),t(5,"p"),r(6),i(),t(7,"button",34),f("click",function(){b(e);let p=d();return x(p.loadBitacoras())}),r(8,"Reintentar"),i()()}if(n&2){let e=d();a(6),v(e.error)}}function le(n,o){if(n&1&&s(0,"img",56),n&2){let e=d().$implicit,c=d(2);l("src",c.getImageUrl(e.imagenUrl),S)("alt",e.titulo)}}function de(n,o){n&1&&(t(0,"div",57),g(),t(1,"svg",58),s(2,"rect",59)(3,"circle",60)(4,"polyline",61),i()())}function se(n,o){if(n&1&&(t(0,"p",62),r(1),i()),n&2){let e=d().$implicit,c=d(2);a(),h(" ",c.truncateText(e.descripcion,100)," ")}}function pe(n,o){if(n&1){let e=C();t(0,"div",37)(1,"div",38),m(2,le,1,2,"img",39)(3,de,5,0,"div",40),i(),t(4,"div",41)(5,"div",42),r(6),i(),t(7,"h3",43),r(8),i(),t(9,"p",44),r(10),D(11,"date"),i(),m(12,se,2,1,"p",45),t(13,"div",46)(14,"a",47),g(),t(15,"svg",48),s(16,"path",49)(17,"circle",50),i(),r(18," Ver "),i(),_(),t(19,"a",51),g(),t(20,"svg",48),s(21,"path",52),i(),r(22," Editar "),i(),_(),t(23,"button",53),f("click",function(){let p=b(e).$implicit,u=d(2);return x(u.confirmDelete(p))}),g(),t(24,"svg",48),s(25,"polyline",54)(26,"path",55),i(),r(27," Eliminar "),i()()()()}if(n&2){let e=o.$implicit,c=d(2);a(2),l("ngIf",e.imagenUrl),a(),l("ngIf",!e.imagenUrl),a(2),L("data-category",e.categoria),a(),h(" ",c.getCategoriaName(e.categoria)," "),a(2),v(e.titulo),a(2),v(F(11,9,e.fecha,"dd/MM/yyyy")),a(2),l("ngIf",e.descripcion),a(2),l("routerLink",w(12,Z,e.id)),a(5),l("routerLink",w(14,ee,e.id))}}function ge(n,o){if(n&1&&(t(0,"div",35),m(1,pe,28,16,"div",36),i()),n&2){let e=d();a(),l("ngForOf",e.bitacoras)}}function me(n,o){n&1&&(t(0,"div",63)(1,"a",64),g(),t(2,"svg",9),s(3,"line",65)(4,"polyline",66),i(),r(5," Ver en l\xEDnea de tiempo "),i()()),n&2&&(a(),l("routerLink",y(1,te)))}function fe(n,o){n&1&&(t(0,"span"),r(1,"Eliminar"),i())}function be(n,o){n&1&&(t(0,"span"),r(1,"Eliminando..."),i())}function xe(n,o){if(n&1){let e=C();t(0,"div",67)(1,"div",68)(2,"div",69)(3,"div",70)(4,"h3"),r(5,"Confirmar eliminaci\xF3n"),i(),t(6,"button",71),f("click",function(){b(e);let p=d();return x(p.cancelDelete())}),g(),t(7,"svg",30),s(8,"line",72)(9,"line",73),i()()(),_(),t(10,"div",74)(11,"p"),r(12,"\xBFEst\xE1s seguro de que deseas eliminar la bit\xE1cora "),t(13,"strong"),r(14),i(),r(15,"?"),i(),t(16,"p",75),r(17,"Esta acci\xF3n no se puede deshacer."),i()(),t(18,"div",76)(19,"button",77),f("click",function(){b(e);let p=d();return x(p.cancelDelete())}),r(20,"Cancelar"),i(),t(21,"button",78),f("click",function(){b(e);let p=d();return x(p.deleteBitacora())}),m(22,fe,2,0,"span",27)(23,be,2,0,"span",27),i()()()()()}if(n&2){let e=d();a(14),h('"',e.bitacoraToDelete==null?null:e.bitacoraToDelete.titulo,'"'),a(7),l("disabled",e.deleting),a(),l("ngIf",!e.deleting),a(),l("ngIf",e.deleting)}}var Q=class n{constructor(o){this.bitacoraService=o}bitacoras=[];loading=!0;error=null;selectedCategoria="";categoriaEntries=Object.entries(k);showDeleteModal=!1;bitacoraToDelete=null;deleting=!1;ngOnInit(){this.loadBitacoras()}loadBitacoras(){this.loading=!0,this.error=null,this.bitacoraService.getAllBitacoras(!0,this.selectedCategoria).pipe(P(o=>(this.error=o.message||"Error al cargar las bit\xE1coras",O([]))),M(()=>this.loading=!1)).subscribe(o=>{this.bitacoras=o})}onCategoriaFilterChange(){this.loadBitacoras()}getImageUrl(o){return this.bitacoraService.getImageUrl(o)}getCategoriaName(o){return k[o]||o}truncateText(o,e){return o.length<=e?o:o.slice(0,e)+"..."}confirmDelete(o){this.bitacoraToDelete=o,this.showDeleteModal=!0}cancelDelete(){this.showDeleteModal=!1,this.bitacoraToDelete=null}deleteBitacora(){!this.bitacoraToDelete||this.deleting||(this.deleting=!0,this.bitacoraService.deleteBitacora(this.bitacoraToDelete.id).pipe(M(()=>{this.deleting=!1,this.showDeleteModal=!1,this.bitacoraToDelete=null})).subscribe({next:()=>{},error:o=>{this.error=o.message||"Error al eliminar la bit\xE1cora"}}))}static \u0275fac=function(e){return new(e||n)(E(K))};static \u0275cmp=B({type:n,selectors:[["app-bitacora-list"]],decls:24,vars:10,consts:[[1,"container"],[1,"bitacoras-header"],[1,"actions"],[1,"filter-container"],["for","categoria-filter"],["id","categoria-filter",1,"categoria-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"btn-create",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["x1","12","y1","5","x2","12","y2","19"],["x1","5","y1","12","x2","19","y2","12"],["class","loading-container",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","error-message",4,"ngIf"],["class","bitacoras-grid",4,"ngIf"],["class","timeline-link-container",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[3,"value"],[1,"loading-container"],[1,"loading-spinner"],[1,"empty-state"],["xmlns","http://www.w3.org/2000/svg","width","64","height","64","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],["d","M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"],["points","14 2 14 8 20 8"],["x1","12","y1","18","x2","12","y2","12"],["x1","9","y1","15","x2","15","y2","15"],[4,"ngIf"],[1,"btn-create-empty",3,"routerLink"],[1,"error-message"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","12","r","10"],["x1","12","y1","8","x2","12","y2","12"],["x1","12","y1","16","x2","12.01","y2","16"],[1,"btn-retry",3,"click"],[1,"bitacoras-grid"],["class","bitacora-card",4,"ngFor","ngForOf"],[1,"bitacora-card"],[1,"bitacora-image"],[3,"src","alt",4,"ngIf"],["class","no-image",4,"ngIf"],[1,"bitacora-content"],[1,"bitacora-category"],[1,"bitacora-title"],[1,"bitacora-date"],["class","bitacora-description",4,"ngIf"],[1,"bitacora-actions"],[1,"btn-view",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"],["cx","12","cy","12","r","3"],[1,"btn-edit",3,"routerLink"],["d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"],[1,"btn-delete",3,"click"],["points","3 6 5 6 21 6"],["d","M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"],[3,"src","alt"],[1,"no-image"],["xmlns","http://www.w3.org/2000/svg","width","48","height","48","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],["x","3","y","3","width","18","height","18","rx","2","ry","2"],["cx","8.5","cy","8.5","r","1.5"],["points","21 15 16 10 5 21"],[1,"bitacora-description"],[1,"timeline-link-container"],[1,"timeline-link",3,"routerLink"],["x1","12","y1","19","x2","12","y2","5"],["points","5 12 12 5 19 12"],[1,"modal-overlay"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"btn-close",3,"click"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"modal-body"],[1,"warning-text"],[1,"modal-footer"],[1,"btn-cancel",3,"click"],[1,"btn-confirm-delete",3,"click","disabled"]],template:function(e,c){e&1&&(s(0,"app-navbar"),t(1,"div",0)(2,"div",1)(3,"h2"),r(4,"Mis Bit\xE1coras Ambientales"),i(),t(5,"div",2)(6,"div",3)(7,"label",4),r(8,"Filtrar por:"),i(),t(9,"select",5),V("ngModelChange",function(u){return T(c.selectedCategoria,u)||(c.selectedCategoria=u),u}),f("change",function(){return c.onCategoriaFilterChange()}),t(10,"option",6),r(11,"Todas las categor\xEDas"),i(),m(12,ne,2,2,"option",7),i()(),t(13,"a",8),g(),t(14,"svg",9),s(15,"line",10)(16,"line",11),i(),r(17," Crear Bit\xE1cora "),i()()(),m(18,ie,4,0,"div",12)(19,re,12,4,"div",13)(20,ce,9,1,"div",14)(21,ge,2,1,"div",15)(22,me,6,2,"div",16)(23,xe,24,4,"div",17),i()),e&2&&(a(9),I("ngModel",c.selectedCategoria),a(3),l("ngForOf",c.categoriaEntries),a(),l("routerLink",y(9,X)),a(5),l("ngIf",c.loading),a(),l("ngIf",!c.loading&&c.bitacoras.length===0),a(),l("ngIf",c.error),a(),l("ngIf",!c.loading&&c.bitacoras.length>0),a(),l("ngIf",!c.loading&&c.bitacoras.length>0),a(),l("ngIf",c.showDeleteModal))},dependencies:[G,j,z,N,H,U,J,q,Y,$,R,W,A],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.bitacoras-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;flex-wrap:wrap;gap:16px}.bitacoras-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#00b359;margin:0}.actions[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;flex-wrap:wrap}.filter-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.categoria-select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #ccc;border-radius:4px;background-color:#fff;font-size:.9rem}.btn-create[_ngcontent-%COMP%]{display:inline-flex;align-items:center;background-color:#00b359;color:#fff;text-decoration:none;padding:8px 16px;border-radius:4px;font-weight:500;gap:8px;transition:background-color .3s ease}.btn-create[_ngcontent-%COMP%]:hover{background-color:#00994d}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 0}.loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(0,179,89,.2);border-radius:50%;border-top-color:#00b359;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:16px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px 0;color:#666}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#aaa;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:12px;color:#333}.btn-create-empty[_ngcontent-%COMP%]{display:inline-block;background-color:#00b359;color:#fff;text-decoration:none;padding:10px 20px;border-radius:4px;font-weight:500;margin-top:16px;transition:background-color .3s ease}.btn-create-empty[_ngcontent-%COMP%]:hover{background-color:#00994d}.error-message[_ngcontent-%COMP%]{background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;padding:16px;margin-bottom:24px;color:#721c24;display:flex;align-items:center;gap:12px}.btn-retry[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none;border-radius:4px;padding:6px 12px;cursor:pointer;margin-left:auto}.bitacoras-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:24px}.bitacora-card[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000001a;background-color:#fff;transition:transform .3s ease,box-shadow .3s ease}.bitacora-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 4px 12px #00000026}.bitacora-image[_ngcontent-%COMP%]{height:180px;background-color:#f8f9fa;position:relative;overflow:hidden}.bitacora-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.bitacora-card[_ngcontent-%COMP%]:hover   .bitacora-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.05)}.no-image[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100%;background-color:#f0f0f0;color:#aaa}.bitacora-content[_ngcontent-%COMP%]{padding:16px}.bitacora-category[_ngcontent-%COMP%]{display:inline-block;font-size:.8rem;font-weight:600;padding:4px 8px;border-radius:4px;margin-bottom:8px;text-transform:uppercase;letter-spacing:.5px}.bitacora-category[data-category=plantacion][_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.bitacora-category[data-category=reciclaje][_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.bitacora-category[data-category=conservacion][_ngcontent-%COMP%]{background-color:#e0f7fa;color:#00838f}.bitacora-category[data-category=educacion][_ngcontent-%COMP%]{background-color:#fff8e1;color:#ff8f00}.bitacora-category[data-category=ahorro][_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.bitacora-category[data-category=consumo][_ngcontent-%COMP%]{background-color:#fff3e0;color:#e65100}.bitacora-category[data-category=limpieza][_ngcontent-%COMP%]{background-color:#e8eaf6;color:#3949ab}.bitacora-category[data-category=otro][_ngcontent-%COMP%]{background-color:#f5f5f5;color:#616161}.bitacora-title[_ngcontent-%COMP%]{font-size:1.2rem;margin:0 0 4px;color:#333}.bitacora-date[_ngcontent-%COMP%]{font-size:.9rem;color:#666;margin:0 0 8px}.bitacora-description[_ngcontent-%COMP%]{font-size:.95rem;color:#555;margin:0 0 16px;line-height:1.5}.bitacora-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-view[_ngcontent-%COMP%], .btn-edit[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:6px 12px;border-radius:4px;font-size:.9rem;cursor:pointer;transition:all .2s ease;text-decoration:none}.btn-view[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2;border:1px solid #bbdefb}.btn-edit[_ngcontent-%COMP%]{background-color:#fff8e1;color:#ff8f00;border:1px solid #ffe082}.btn-delete[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828;border:1px solid #ffcdd2}.btn-view[_ngcontent-%COMP%]:hover{background-color:#bbdefb}.btn-edit[_ngcontent-%COMP%]:hover{background-color:#ffe082}.btn-delete[_ngcontent-%COMP%]:hover{background-color:#ffcdd2}.timeline-link-container[_ngcontent-%COMP%]{text-align:center;margin:32px 0}.timeline-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;background-color:#f5f5f5;color:#333;text-decoration:none;padding:10px 16px;border-radius:4px;font-weight:500;transition:background-color .3s ease}.timeline-link[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-dialog[_ngcontent-%COMP%]{width:100%;max-width:500px;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 4px 12px #0003}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;border-bottom:1px solid #eee}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333}.btn-close[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;color:#666}.modal-body[_ngcontent-%COMP%]{padding:16px}.warning-text[_ngcontent-%COMP%]{color:#dc3545;font-weight:500}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px;border-top:1px solid #eee}.btn-cancel[_ngcontent-%COMP%], .btn-confirm-delete[_ngcontent-%COMP%]{padding:8px 16px;border-radius:4px;font-weight:500;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #dee2e6;color:#212529}.btn-confirm-delete[_ngcontent-%COMP%]{background-color:#dc3545;border:1px solid #dc3545;color:#fff}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#e2e6ea}.btn-confirm-delete[_ngcontent-%COMP%]:hover{background-color:#c82333}.btn-confirm-delete[_ngcontent-%COMP%]:disabled{background-color:#e4606d;cursor:not-allowed}@media (max-width: 768px){.bitacoras-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.actions[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.bitacoras-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{Q as BitacoraListComponent};
