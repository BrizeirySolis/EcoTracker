import{a as y,b as x,c as H}from"./chunk-42JKTXX6.js";import{Ba as g,Ca as A,Da as b,Fa as R,Ga as S,I as d,Ja as T,Ka as k,Ma as i,R as m,S as s,T as f,ba as C,oa as v,q as u,t as c,u as h}from"./chunk-22ZNRLWF.js";var o=class t{constructor(e,r){this.router=e;this.authService=r}canActivate(e,r){if(this.authService.isLoggedIn()){if(e.data.roles&&e.data.roles.length){let n=this.authService.currentUserValue?.roles||[];if(!e.data.roles.some(P=>n.includes(P)))return this.router.navigate(["/home"]),!1}return!0}return this.router.navigate(["/login"],{queryParams:{returnUrl:r.url}}),!1}static \u0275fac=function(r){return new(r||t)(c(S),c(i))};static \u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})};var I=[{path:"",redirectTo:"/home",pathMatch:"full"},{path:"home",loadComponent:()=>import("./chunk-MLEYPR6F.js").then(t=>t.HomeComponent)},{path:"login",loadComponent:()=>import("./chunk-6EESYRB2.js").then(t=>t.LoginComponent)},{path:"register",loadComponent:()=>import("./chunk-WEWGYHYU.js").then(t=>t.RegisterComponent)},{path:"habitos",loadComponent:()=>import("./chunk-CYTUGI2J.js").then(t=>t.HabitsComponent),canActivate:[o]},{path:"luz",loadComponent:()=>import("./chunk-FURJP2VQ.js").then(t=>t.ElectricityFormComponent),canActivate:[o]},{path:"agua",loadComponent:()=>import("./chunk-CABTNYEF.js").then(t=>t.WaterFormComponent),canActivate:[o]},{path:"transporte",loadComponent:()=>import("./chunk-Z7AAU7GZ.js").then(t=>t.TransportFormComponent),canActivate:[o]},{path:"profile",loadComponent:()=>import("./chunk-MZFERS3Y.js").then(t=>t.ProfileComponent),canActivate:[o]},{path:"bitacoras",loadComponent:()=>import("./chunk-CAEC4HVE.js").then(t=>t.BitacoraListComponent),canActivate:[o]},{path:"bitacoras/new",loadComponent:()=>import("./chunk-42S6NF2C.js").then(t=>t.BitacoraFormComponent),canActivate:[o]},{path:"bitacoras/edit/:id",loadComponent:()=>import("./chunk-42S6NF2C.js").then(t=>t.BitacoraFormComponent),canActivate:[o]},{path:"bitacoras/:id",loadComponent:()=>import("./chunk-FSIWQ7WR.js").then(t=>t.BitacoraDetailComponent),canActivate:[o]},{path:"bitacoras/timeline",loadComponent:()=>import("./chunk-3DIJ2J6Y.js").then(t=>t.BitacoraTimelineComponent),canActivate:[o]},{path:"**",redirectTo:"/home"}];var F=(t,e)=>{let r=h(i);console.log("Interceptando solicitud a:",t.url);let n=r.currentUserValue;if(n&&n.token){console.log("Token encontrado, a\xF1adiendo a la solicitud");let l=n.token.startsWith("Bearer ")?n.token:`Bearer ${n.token}`,p=t.clone({setHeaders:{Authorization:l}});return console.log("Authorization header a\xF1adido:",p.headers.get("Authorization")?.substring(0,25)+"..."),e(p)}return console.log("No hay token disponible, continuando sin Authorization"),e(t)};var w={providers:[v({eventCoalescing:!0}),T(I,k({skipInitialTransition:!0,onViewTransitionCreated:t=>{console.log("View transition created for:",t.to.url)}})),g(A([F])),x,H,y]};var a=class t{title="EcoTracker";static \u0275fac=function(r){return new(r||t)};static \u0275cmp=d({type:t,selectors:[["app-root"]],decls:5,vars:0,template:function(r,n){r&1&&(m(0,"main"),f(1,"router-outlet"),s(),m(2,"footer")(3,"p"),C(4,"\xA9 2025 EcoTracker - Proyecto educativo"),s()())},dependencies:[R],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;min-height:100vh}main[_ngcontent-%COMP%]{flex:1}footer[_ngcontent-%COMP%]{background-color:#333;color:#fff;text-align:center;padding:16px;margin-top:40px}"]})};b(a,w).catch(t=>console.error(t));
