import{a as L,b as R,c as z}from"./chunk-K5HPOKWK.js";import{a as j}from"./chunk-NNOWFRW7.js";import"./chunk-2XZSZ3Q7.js";import{A as g,B as u,Fa as E,Ga as B,I as k,J as a,L as v,La as D,M as P,Na as T,Q as m,S as w,T as c,Va as V,Xa as A,Y as t,Ya as F,Z as n,_ as p,ba as C,ca as _,da as d,ja as r,ka as f,la as h,m as y,ra as S,sa as I,ua as M,wa as O,y as b,z as x}from"./chunk-K5VQB3RE.js";var N=()=>["/bitacoras"],U=i=>["/bitacoras/edit",i];function H(i,o){if(i&1){let e=C();t(0,"div",12)(1,"a",13),g(),t(2,"svg",14),p(3,"path",15),n(),r(4," Editar "),n(),u(),t(5,"button",16),_("click",function(){b(e);let s=d();return x(s.confirmDelete())}),g(),t(6,"svg",14),p(7,"polyline",17)(8,"path",18),n(),r(9," Eliminar "),n()()}if(i&2){let e=d();a(),c("routerLink",I(1,U,e.bitacora.id))}}function q(i,o){i&1&&(t(0,"div",19),p(1,"div",20),t(2,"p"),r(3,"Cargando bit\xE1cora..."),n()())}function $(i,o){if(i&1){let e=C();t(0,"div",21),g(),t(1,"svg",22),p(2,"circle",23)(3,"line",24)(4,"line",25),n(),u(),t(5,"p"),r(6),n(),t(7,"button",26),_("click",function(){b(e);let s=d();return x(s.loadBitacora())}),r(8,"Reintentar"),n()()}if(i&2){let e=d();a(6),f(e.error)}}function J(i,o){if(i&1&&(t(0,"div",41),p(1,"img",42),n()),i&2){let e=d(2);a(),c("src",e.getImageUrl(e.bitacora.imagenUrl),k)("alt",e.bitacora.titulo)}}function K(i,o){if(i&1&&(t(0,"p",43),r(1),n()),i&2){let e=d(2);a(),f(e.bitacora.descripcion)}}function Q(i,o){if(i&1&&(t(0,"div",47)(1,"div",48),r(2),n(),t(3,"div",49),r(4),n()()),i&2){let e=o.$implicit,l=d(3);a(2),f(l.getAdditionalFieldLabel(e[0])),a(2),f(e[1])}}function W(i,o){if(i&1&&(t(0,"div",44)(1,"h3"),r(2,"Informaci\xF3n adicional"),n(),t(3,"div",45),m(4,Q,5,2,"div",46),n()()),i&2){let e=d(2);a(4),c("ngForOf",e.additionalFieldsEntries)}}function X(i,o){if(i&1&&(t(0,"div",27)(1,"div",28),r(2),n(),t(3,"h1",29),r(4),n(),t(5,"div",30),g(),t(6,"svg",4),p(7,"rect",31)(8,"line",32)(9,"line",33)(10,"line",34),n(),u(),t(11,"span"),r(12),M(13,"date"),n()(),t(14,"div",35),m(15,J,2,2,"div",36),t(16,"div",37),m(17,K,2,1,"p",38)(18,W,5,1,"div",39),t(19,"div",40)(20,"p"),r(21),M(22,"date"),n()()()()()),i&2){let e=d();a(),w("data-category",e.bitacora.categoria),a(),h(" ",e.getCategoriaName(e.bitacora.categoria)," "),a(2),f(e.bitacora.titulo),a(8),f(O(13,8,e.bitacora.fecha,"longDate")),a(3),c("ngIf",e.bitacora.imagenUrl),a(2),c("ngIf",e.bitacora.descripcion),a(),c("ngIf",e.hasAdditionalFields),a(3),h("Creado el ",O(22,11,e.bitacora.createdAt,"medium"),"")}}function Y(i,o){i&1&&(t(0,"span"),r(1,"Eliminar"),n())}function Z(i,o){i&1&&(t(0,"span"),r(1,"Eliminando..."),n())}function ee(i,o){if(i&1){let e=C();t(0,"div",50)(1,"div",51)(2,"div",52)(3,"div",53)(4,"h3"),r(5,"Confirmar eliminaci\xF3n"),n(),t(6,"button",54),_("click",function(){b(e);let s=d();return x(s.cancelDelete())}),g(),t(7,"svg",22),p(8,"line",55)(9,"line",56),n()()(),u(),t(10,"div",57)(11,"p"),r(12,"\xBFEst\xE1s seguro de que deseas eliminar la bit\xE1cora "),t(13,"strong"),r(14),n(),r(15,"?"),n(),t(16,"p",58),r(17,"Esta acci\xF3n no se puede deshacer."),n()(),t(18,"div",59)(19,"button",60),_("click",function(){b(e);let s=d();return x(s.cancelDelete())}),r(20,"Cancelar"),n(),t(21,"button",61),_("click",function(){b(e);let s=d();return x(s.deleteBitacora())}),m(22,Y,2,0,"span",62)(23,Z,2,0,"span",62),n()()()()()}if(i&2){let e=d();a(14),h('"',e.bitacora==null?null:e.bitacora.titulo,'"'),a(7),c("disabled",e.deleting),a(),c("ngIf",!e.deleting),a(),c("ngIf",e.deleting)}}var G=class i{constructor(o,e,l){this.bitacoraService=o;this.route=e;this.router=l}bitacora=null;loading=!0;error=null;bitacoraId=0;showDeleteModal=!1;deleting=!1;ngOnInit(){if(this.bitacoraId=+this.route.snapshot.paramMap.get("id"),isNaN(this.bitacoraId)||this.bitacoraId<=0){this.error="ID de bit\xE1cora inv\xE1lido",this.loading=!1;return}this.loadBitacora()}loadBitacora(){this.loading=!0,this.error=null,this.bitacoraService.getBitacoraById(this.bitacoraId).pipe(y(()=>this.loading=!1)).subscribe({next:o=>{this.bitacora=o},error:o=>{this.error=o.message||"Error al cargar la bit\xE1cora"}})}getImageUrl(o){return this.bitacoraService.getImageUrl(o)}getCategoriaName(o){return R[o]||o}get hasAdditionalFields(){return!!this.bitacora?.camposAdicionales&&Object.keys(this.bitacora.camposAdicionales??{}).length>0}get additionalFieldsEntries(){return this.bitacora?.camposAdicionales?Object.entries(this.bitacora.camposAdicionales):[]}getAdditionalFieldLabel(o){return this.bitacora?.categoria&&(L[this.bitacora.categoria]||[]).find(s=>s.nombre===o)?.etiqueta||o}confirmDelete(){this.showDeleteModal=!0}cancelDelete(){this.showDeleteModal=!1}deleteBitacora(){!this.bitacora||this.deleting||(this.deleting=!0,this.bitacoraService.deleteBitacora(this.bitacora.id).pipe(y(()=>{this.deleting=!1,this.showDeleteModal=!1})).subscribe({next:()=>{this.router.navigate(["/bitacoras"])},error:o=>{this.error=o.message||"Error al eliminar la bit\xE1cora"}}))}static \u0275fac=function(e){return new(e||i)(v(z),v(V),v(A))};static \u0275cmp=P({type:i,selectors:[["app-bitacora-detail"]],decls:14,vars:7,consts:[[1,"container"],[1,"page-header"],[1,"header-navigation"],[1,"btn-back",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["x1","19","y1","12","x2","5","y2","12"],["points","12 19 5 12 12 5"],["class","header-actions",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","error-message",4,"ngIf"],["class","bitacora-detail",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[1,"header-actions"],[1,"btn-edit",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"],[1,"btn-delete",3,"click"],["points","3 6 5 6 21 6"],["d","M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"],[1,"loading-container"],[1,"loading-spinner"],[1,"error-message"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","12","r","10"],["x1","12","y1","8","x2","12","y2","12"],["x1","12","y1","16","x2","12.01","y2","16"],[1,"btn-retry",3,"click"],[1,"bitacora-detail"],[1,"bitacora-category"],[1,"bitacora-title"],[1,"bitacora-date"],["x","3","y","4","width","18","height","18","rx","2","ry","2"],["x1","16","y1","2","x2","16","y2","6"],["x1","8","y1","2","x2","8","y2","6"],["x1","3","y1","10","x2","21","y2","10"],[1,"bitacora-content"],["class","bitacora-image-container",4,"ngIf"],[1,"bitacora-text"],["class","bitacora-description",4,"ngIf"],["class","additional-fields",4,"ngIf"],[1,"creation-info"],[1,"bitacora-image-container"],[1,"bitacora-image",3,"src","alt"],[1,"bitacora-description"],[1,"additional-fields"],[1,"additional-fields-grid"],["class","additional-field",4,"ngFor","ngForOf"],[1,"additional-field"],[1,"field-label"],[1,"field-value"],[1,"modal-overlay"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"btn-close",3,"click"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"modal-body"],[1,"warning-text"],[1,"modal-footer"],[1,"btn-cancel",3,"click"],[1,"btn-confirm-delete",3,"click","disabled"],[4,"ngIf"]],template:function(e,l){e&1&&(p(0,"app-navbar"),t(1,"div",0)(2,"div",1)(3,"div",2)(4,"a",3),g(),t(5,"svg",4),p(6,"line",5)(7,"polyline",6),n(),r(8," Volver a la lista "),n()(),m(9,H,10,3,"div",7),n(),m(10,q,4,0,"div",8)(11,$,9,1,"div",9)(12,X,23,14,"div",10)(13,ee,24,4,"div",11),n()),e&2&&(a(4),c("routerLink",S(6,N)),a(5),c("ngIf",l.bitacora),a(),c("ngIf",l.loading),a(),c("ngIf",l.error),a(),c("ngIf",!l.loading&&l.bitacora),a(),c("ngIf",l.showDeleteModal))},dependencies:[T,E,B,D,F,j],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:1000px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.header-navigation[_ngcontent-%COMP%], .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.btn-back[_ngcontent-%COMP%], .btn-edit[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:8px 16px;border-radius:4px;font-weight:500;transition:all .2s ease;cursor:pointer}.btn-back[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#333;text-decoration:none}.btn-edit[_ngcontent-%COMP%]{background-color:#fff8e1;color:#ff8f00;border:1px solid #ffe082;text-decoration:none}.btn-delete[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828;border:1px solid #ffcdd2}.btn-back[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.btn-edit[_ngcontent-%COMP%]:hover{background-color:#ffe082}.btn-delete[_ngcontent-%COMP%]:hover{background-color:#ffcdd2}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 0}.loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(0,179,89,.2);border-radius:50%;border-top-color:#00b359;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:16px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;padding:16px;margin-bottom:24px;color:#721c24;display:flex;align-items:center;gap:12px}.btn-retry[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none;border-radius:4px;padding:6px 12px;cursor:pointer;margin-left:auto}.bitacora-detail[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000001a}.bitacora-category[_ngcontent-%COMP%]{display:inline-block;font-size:.9rem;font-weight:600;padding:6px 12px;border-radius:4px;margin:20px 20px 0;text-transform:uppercase;letter-spacing:.5px}.bitacora-category[data-category=plantacion][_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.bitacora-category[data-category=reciclaje][_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.bitacora-category[data-category=conservacion][_ngcontent-%COMP%]{background-color:#e0f7fa;color:#00838f}.bitacora-category[data-category=educacion][_ngcontent-%COMP%]{background-color:#fff8e1;color:#ff8f00}.bitacora-category[data-category=ahorro][_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.bitacora-category[data-category=consumo][_ngcontent-%COMP%]{background-color:#fff3e0;color:#e65100}.bitacora-category[data-category=limpieza][_ngcontent-%COMP%]{background-color:#e8eaf6;color:#3949ab}.bitacora-category[data-category=otro][_ngcontent-%COMP%]{background-color:#f5f5f5;color:#616161}.bitacora-title[_ngcontent-%COMP%]{font-size:2rem;margin:12px 20px 16px;color:#333}.bitacora-date[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#666;margin:0 20px 20px}.bitacora-content[_ngcontent-%COMP%]{padding:0 0 24px}.bitacora-image-container[_ngcontent-%COMP%]{margin-bottom:24px;overflow:hidden;max-height:500px}.bitacora-image[_ngcontent-%COMP%]{width:100%;object-fit:cover}.bitacora-text[_ngcontent-%COMP%]{padding:0 20px}.bitacora-description[_ngcontent-%COMP%]{font-size:1.1rem;line-height:1.6;color:#333;margin-bottom:24px;white-space:pre-line}.additional-fields[_ngcontent-%COMP%]{background-color:#f9f9f9;border-radius:6px;padding:20px;margin-bottom:24px}.additional-fields[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:16px;color:#333}.additional-fields-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.additional-field[_ngcontent-%COMP%]{margin-bottom:8px}.field-label[_ngcontent-%COMP%]{font-weight:600;color:#555;margin-bottom:4px}.field-value[_ngcontent-%COMP%]{color:#333}.creation-info[_ngcontent-%COMP%]{color:#777;font-size:.9rem;margin-top:24px;padding-top:16px;border-top:1px solid #eee}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-dialog[_ngcontent-%COMP%]{width:100%;max-width:500px;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 4px 12px #0003}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;border-bottom:1px solid #eee}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333}.btn-close[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;color:#666}.modal-body[_ngcontent-%COMP%]{padding:16px}.warning-text[_ngcontent-%COMP%]{color:#dc3545;font-weight:500}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px;border-top:1px solid #eee}.btn-cancel[_ngcontent-%COMP%], .btn-confirm-delete[_ngcontent-%COMP%]{padding:8px 16px;border-radius:4px;font-weight:500;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #dee2e6;color:#212529}.btn-confirm-delete[_ngcontent-%COMP%]{background-color:#dc3545;border:1px solid #dc3545;color:#fff}.btn-cancel[_ngcontent-%COMP%]:hover{background-color:#e2e6ea}.btn-confirm-delete[_ngcontent-%COMP%]:hover{background-color:#c82333}.btn-confirm-delete[_ngcontent-%COMP%]:disabled{background-color:#e4606d;cursor:not-allowed}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}}"]})};export{G as BitacoraDetailComponent};
