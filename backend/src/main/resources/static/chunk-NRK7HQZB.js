import{a as v}from"./chunk-WFRQKCWH.js";import{a as u,b as h}from"./chunk-2XZSZ3Q7.js";import{Qa as m,Xa as l,a,b as o,i as c,j as n,l as r,p as s,s as d,v as i}from"./chunk-K5VQB3RE.js";var g=class p{constructor(t,e,y,C){this.http=t;this.authService=e;this.router=y;this.metaService=C}API_URL=u.apiUrl;handleError(t){return console.error("Error en la solicitud HTTP:",t),t.status===401&&(console.log("Error de autenticaci\xF3n. Redirigiendo al login..."),this.authService.logout(),this.router.navigate(["/login"],{queryParams:{returnUrl:this.router.url,authError:"Tu sesi\xF3n ha expirado o no es v\xE1lida. Por favor, inicia sesi\xF3n nuevamente."}})),c(()=>t)}getConsumptionSummary(){return this.http.get(`${this.API_URL}/summary`).pipe(r(this.handleError.bind(this)))}saveElectricityConsumption(t){return this.http.post(`${this.API_URL}/electricity`,t).pipe(s(()=>{this.metaService.notifyConsumptionUpdated("electricidad"),console.log("Consumo de electricidad guardado, notificaci\xF3n enviada")}),r(this.handleError.bind(this)))}getElectricityConsumption(){return this.http.get(`${this.API_URL}/electricity`).pipe(n(t=>t.map(e=>o(a({},e),{date:new Date(e.date)}))),r(this.handleError.bind(this)))}saveWaterConsumption(t){return this.http.post(`${this.API_URL}/water`,t).pipe(s(()=>{this.metaService.notifyConsumptionUpdated("agua"),console.log("Consumo de agua guardado, notificaci\xF3n enviada")}),r(this.handleError.bind(this)))}getWaterConsumption(){return this.http.get(`${this.API_URL}/water`).pipe(n(t=>t.map(e=>o(a({},e),{date:new Date(e.date)}))),r(this.handleError.bind(this)))}saveTransportUsage(t){return this.http.post(`${this.API_URL}/transport`,t).pipe(s(()=>{this.metaService.notifyConsumptionUpdated("transporte"),console.log("Consumo de transporte guardado, notificaci\xF3n enviada")}),r(this.handleError.bind(this)))}getTransportUsage(){return this.http.get(`${this.API_URL}/transport`).pipe(n(t=>t.map(e=>o(a({},e),{date:new Date(e.date)}))),r(this.handleError.bind(this)))}getMockWaterData(){return[{id:1,liters:5.2,date:new Date(2025,2,10),cost:120},{id:2,liters:8,date:new Date(2025,2,17),cost:190},{id:3,liters:6.1,date:new Date(2025,2,24),cost:135},{id:4,liters:7.2,date:new Date(2025,3,1),cost:150},{id:5,liters:4,date:new Date(2025,3,8),cost:100}]}getMockElectricityData(){return[{id:1,kilowatts:120,date:new Date(2025,2,10),cost:240},{id:2,kilowatts:150,date:new Date(2025,2,17),cost:300},{id:3,kilowatts:130,date:new Date(2025,2,24),cost:260},{id:4,kilowatts:140,date:new Date(2025,3,1),cost:280},{id:5,kilowatts:110,date:new Date(2025,3,8),cost:220}]}getMockTransportData(){return[{id:1,kilometers:20,transportType:"car",date:new Date(2025,2,10),cost:50},{id:2,kilometers:15,transportType:"bus",date:new Date(2025,2,17),cost:30},{id:3,kilometers:25,transportType:"car",date:new Date(2025,2,24),cost:60},{id:4,kilometers:18,transportType:"car",date:new Date(2025,3,1),cost:45},{id:5,kilometers:12,transportType:"bicycle",date:new Date(2025,3,8),cost:0}]}getMockSummaryData(){return[{label:"Agua",value:100,percentage:30},{label:"Electricidad",value:150,percentage:45},{label:"Transporte",value:80,percentage:25}]}static \u0275fac=function(e){return new(e||p)(i(m),i(h),i(l),i(v))};static \u0275prov=d({token:p,factory:p.\u0275fac,providedIn:"root"})};export{g as a};
